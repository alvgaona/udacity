# TV Script Generation

A project from Deep Learning Nanodegree at Udacity.
In this project you will find a neural network trained to generate a TV
script based on the TV show Seinfeld aired on July 5, 1989.

<img src="/images/seinfeld.jpg" width="580" alt="Seinfeld" />

## Recurrent Neural Networks

The neural network is a specific type of neural networks called, _Recurrent Neural Networks_.
More particularly, a recurrent network with the ability of storing information from previous
steps from way back named _Long Short Term Memory_. 

**LSTM Unit**

<img src="/images/lstm_unit.png" width="650" alt="LSTM Unit" />


## Architecture

The architecture is a simple one, composed of the following layers.

- _Embbedding layer_: This module is often used to store word embeddings and retrieve them using indices.
The input to the module is a list of indices, and the output is the corresponding word embeddings.
- _LSTM layers_: Composed of two stacked layers with the same hidden dimensions.
- _Drop-out layer_: A drop-out layer is used after the first LSTM layer to mitigate overfitting.
- _Fully-connected layer_: Last layer before the output layer to generate the fake script.

## Hyperparameters

```python
sequence_length = 8   # Number of words in a sequence
batch_size = 256      # Batch Size

num_epochs = 15       # Number of Epochs
learning_rate = 0.001 # Learning Rate

embedding_dim = 300   # Embedding Dimension
hidden_dim = 256      # Number of units per layer
n_layers = 2          # Number of LSTM layers
```

## Data Preprocessing

For preprocessing you can follow this [link][Preprocessing].

## Results

Below you can find the training loss decreasing until epoch 15.
Going further with this hyperparameters makes no sense since it'll get stuck
on some local minimum.

![Training]

An here there's an extract of the fake script generated by the neural network.
To see the full script follow this [link][Generated Script].

```text
jerry: not that freakin' itself to the bathroom.

george: oh, no.

elaine: hey, hey! hey, hey, hey! you wanna go get a cup of coffee?

george: no! i was thinking. i don't know what you think.(he hangs up and leaves) hey, what are you doing here?

kramer: oh no i don't... you got the wrong mileage?

jerry: i don't even know.

george: i know, but i don't even want to see you. you know, i mean, what is that?

kramer:(laughing) oh, no...(to george) i don't know what you think.(to george) you see, i think i'm gonna do it.

elaine: oh, i think i was in a good mood. i was just talking about him. i don't want to know what it is.(elaine laughs)

george: what?

george: i was just wondering i was a little nervous, you know, i was just wondering if you don't want to see it.

george: i think i have to be honest with you. i mean, i just wanted to tell you, i never had any trouble in this city?

jerry: i don't know.
```

[Training]: ./images/training.png
[Generated Script]: ./fake_script/generated_script_1.txt
[Preprocessing]: https://github.com/alvgaona/tv-script-generation/blob/master/network/tv_script_generation.ipynb